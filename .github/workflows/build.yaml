name: Translate Plugins

on:
  workflow_dispatch:
#  schedule:
#    - cron: '0 0 * * *' # æ¯å¤© UTC 0 é»

permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          persist-credentials: true
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.12'
      - name: Install dependencies
        run: pip install requests
      - name: Run translation script
        run: python translate_plugins.py
      - name: Commit & Push
        run: |
          git config user.name "GitHub Action"
          git config user.email "action@github.com"
          git add Hans/**/* translation/**/* dict/**/*
          git add dict_string.json dict_url.json
          git commit -m "ç¹åŒ–æ›´æ–°" || echo "No changes to commit"
          git push
      - name: Create/Update Release and Upload Assets
        uses: ncipollo/release-action@v1
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          tag: latest-plugins
          name: ğŸ› ï¸ ç¹é«”åŒ–å¤–æ›æœ€æ–°ç‰ˆ (è‡ªå‹•æ›´æ–°)
          body: æ­¤ Release æœƒè‡ªå‹•è¦†è“‹æ›´æ–°ï¼Œå§‹çµ‚æä¾›æœ€æ–°çš„ç¹é«”åŒ–å¤–æ› ZIP æª”æ¡ˆã€‚
          allowUpdates: true
          overwrite: true
          artifacts: releases/**/*.zip
